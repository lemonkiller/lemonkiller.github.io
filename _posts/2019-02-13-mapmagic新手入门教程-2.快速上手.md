---
layout:     post
title:      mapmagic新手入门教程-2.快速上手
subtitle:   这个插件很棒,自来水一发
date:       2019-02-13
author:     lemonkiller
header-img: \img\mapmagic.jpg
excerpt: 逐渐补完mapmagic的入门教程
catalog: true
tags:
    - unity插件
    - unity
    - MapMagic
---



## 快速上手
您需要做的第一件事是创建一个MapMagic对象，其中包含MapMagic脚本、初始地形，并允许打开编辑器界面。要创建MapMagic对象，请单击游戏对象菜单-> 3D对象-> MapMagic。一个名为“MapMagic”的新游戏对象将出现在层次菜单中。它已经有了最初的固定地形和三个示例生成器，所以地形并不平坦。单击此对象将在检查器中显示基本设置。

“固定地形”按钮允许在场景视图中选择固定地形。左键点击一个空白区域将会锁定一个地形，在地形生成后，它会马上出现。在已经固定的地形上左键点击将会取消固定。要退出锁定模式，再次点击“锁定地形”按钮。

对固定地形所做的任何更改将在下一次生成时重新写入。为了防止这种情况，按下“锁定地形”按钮并选择应该锁定的固定地形，使用地形锁定。当使用锁定地形时，尽量不要大幅修改高度，否则你可以在没有改变的锁定地形和它们的邻居之间获得明显的边界，这些邻居有一个新的程序性高度图。

在您创建的MapMagic对象中，“显示编辑器”按钮将打开编辑器窗口。这里你可以看到三个初始发生器:噪声、曲线和高度(输出发生器)，它们都连接在一起。可以使用鼠标中键滚动编辑器窗口。要放大或缩小，请使用滚轮。要重新定位生成器，请左键单击并拖动生成器窗口上的任意位置。

改变生成器的任何参数都会迫使生成器及其相关生成器重新计算。一旦生成器的结果准备好，地形就会改变。

MapMagic窗口中的"Generate"按钮将强制重新计算编辑器中的所有生成器。

请注意，"Generate"按钮图标会根据当前生成状态更改其外观:

当所有地形都已成功生成并且都是最新的时，将显示绿色“Ok”标记。
当至少一个地形当前正在生成时，将显示灰色“生成”标记(动画)。
红色“错误”标记表示生成器图形存在连接错误:要么强制连接为空，要么连接类型错误，要么图形具有无限循环。错误连接将在图上以红色显示。
当"Generate"按钮旁边没有显示任何内容时，地形尚未生成。这在设置中关闭“即时生成”功能时很常见。

"Generate"按钮旁边是“全局种子”字段。这个数字用于初始化伪随机生成器。请注意，伪随机生成器使用自己的种子参数，因此最终结果取决于全局种子和生成器种子参数。

右键单击空字段，然后从弹出菜单中选择创建- >生成器类型- >生成器，即可创建新生成器。请注意，所有生成器都按类型分组:

地图生成器仅与其他地图生成器连接。他们的输入和输出总是地图。
对象生成器仅与其他对象生成器连接。他们可能有也可能没有地图输入/输出，但对象始终存在。
输出生成器直接设置地形并放置对象。
“门户”实际上不是一个生成器，而是一种连接技术。不要让这个名字愚弄你——它不是关于其他地形或维度的空间洞，它只是更好地组织图表的一种方式。当设置为输入时，该门户会创建一个“无线”连接，该连接可以与匹配的输出门户配对，输入到图形的另一个位置，最大限度地减少显示的长而杂乱的电线数量。

通过右键单击生成器并从弹出菜单中选择“删除”，可以删除生成器。

新创建的生成器可以连接到当前现有的生成器系统。只需将它的输入或输出图标拖放到另一个生成器的输入或输出上。请注意，生成器的输出可以有多个连接，而输入只接受一个连接。一些生成器输入是强制性的，这意味着它们总是需要一些输入，如果没有连接，发电将会失败。空的强制输入用红色星号高亮显示。

![](/img/MapMagic/QuickGuideEditor.jpg)

任何地图生成器的任何输出都可以使用预览功能查看。右键单击地图输出，然后选择预览- >地形。这将根据预览地图值以红色到绿色的颜色范围对地形进行着色。高地图值为绿色，而低值为红色。

要退出预览模式，请右键单击编辑器中的任意位置，然后选择预览- >清除。

此外，地图可以在单独的窗口中预览。单击预览- >在窗口中，将打开一个显示灰度地图的窗口。这个地图可以像主图形一样滚动和缩放。

![](/img/MapMagic/Preview.jpg)

## 设置

选择MapMagic对象时，可以在检查器选项卡中找到常规和地形设置。

常规设置设置MapMagic的参数:

分辨率设置输入和输出地图大小。提高分辨率将创造更详细的地形，但请注意，生成时间将呈平方增长。例如，对于512的地图大小，计算侵蚀发生器(最慢的发生器之一)需要大约2秒，而对于1024的地图大小，相同的操作需要超过7秒。
地形大小以单位设置地形边的长度。此参数仅改变地形对象的比例，不影响性能。请注意，更改尺寸参数需要地形调整，以使地形看起来成比例。
地形高度设置最大地形高程，即值为1的地图像素将在此级别设置地形。
生成无限地形-启用后，当主摄像机靠近边缘时，这将在播放模式下动态生成新的地形，从而创建一个几乎无限的世界。

生成范围-到触发地形生成的地形边界的最小距离。请注意，当到达生成范围时，地形不会立即出现，因为生成需要一些时间，这取决于图形生成器的复杂性。此参数确保生成或开始生成范围内的所有地形。
轨迹计数-当地形不再位于“生成范围”距离内时，MapMagic会移除这些地形，但是如果玩家在离开后想要返回到地形，有一个地形池没有被破坏，并被命名为“轨迹”:当沿着这条线移动时，这些地形会形成相机后面的轨迹。此参数设置未着色的地形池大小。

请注意，在游戏模式下，固定地形永远不会被破坏。这使得手动修改它们成为可能，例如，在自动荒野地形中包括手工村庄。

多线程:启用时，Map Magic在几个单独的线程中工作。关闭此参数将强制Map Magic仅在主线程中工作(这可能有助于调试自定义生成器或出于兼容性原因)。
即时生成:启用此参数后，在更改任何生成器参数后，无需按"Generate"按钮: Map Magic会触发更改，并在您更改图形中的每个节点时自动强制生成。
保存中间结果: Map Magic保存每个生成器的每个地形的输出结果，因此在生成器更改时，不需要重新生成所有内容:只计算生成器的更改及其相关性。禁用该参数时，MapMagic将在生成完成后清除所有生成器映射。禁用此选项可以减少内存占用，但每次任何生成器更改时，整个图表都将从头开始重新生成，这可能需要一些时间，具体取决于图表的复杂性。
焊缝边缘:由于所有的地形都是独立生成的，一些算法，如模糊或侵蚀，可能会在地形的边界上产生不同的结果。为了消除这种差异，MapMagic创造了从一个地形到另一个地形的平滑过渡。“边距”参数是过渡的大小(以像素为单位)。当参数为0时，地形焊接关闭。

高度焊接余量:应用于高度贴图焊接的余量
Splat焊接余量:适用于地形纹理焊接的余量。由于纹理差异不如高度差异明显，建议将此参数设置为低于高度焊接余量。

请记住，使用高边界值会导致更长的应用时间(即Unity生成后冻结的时间)，并可能导致浮动对象错误(当地形降低到对象下方以执行焊接时)。保持这些值尽可能低，并使用安全边界参数来抵消地形差异。

隐藏远固定地形:隐藏不在生成范围内的固定地形，否则将始终显示。禁用此功能会造成地形漂浮在空中的效果，降低性能。
将图层和标签复制到地形:打开MapMagic后，所有分配给MapMagic对象的标签和图层都会在生成时复制到地形。
将组件复制到地形:打开MapMagic时，所有分配给MapMagic对象的脚本(除了MapMagic本身)都会在生成时复制到地形。

“地形设置”和“树”、“细节”和“草”设置等同于标准地形的“设置”选项卡中用于每个地形的设置。唯一不同的是，它们被应用于所有MapMagic地形。有关详细信息，请参阅Unity文档。

